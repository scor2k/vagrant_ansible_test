### Some Test case 

Развернуть кластер из трех виртуальных машин (можно использовать vagrant).

На полученном кластере разместить следующие контейнеры:

  - master-slave кластер из двух нод percona mysql 5.7
  - кластер из двух нод elasticsearch 5.3 без авторизации
  - данный сервис node.js запущенный в 5-и экземплярах

Конфигурация хостов должна осуществляться с помощью системы управления конфигурациями (например, ansible).
Все скрипты и конфигурационные файлы, необходимые для решения задачи нужно вести в git репозитории и выложить его на github или bitbucket.

Доступ к сервису node.js должен осуществляться через reverse-proxy (nginx или HAProxy).
Проверка работы кластера осуществляется через обращение к сервису node.js через http.
 
На этом же кластере организовать сбор логов процессов при помощи logstash и kibana.

### How to run

 * Установите vargant (убедитесь, что ваш процессор поддерживает виртуализацию). 
 * Установите ansible, git
 * Выполните `git clone https://github.com/scor2k/vagrant_ansible_test.git` 
 * Перейдите в созданную папку `vagrant_ansible_test` и выполните команду `vagrant up`.
 * Процесс создания 3х виртуальных машин занимает продолжительное время. По умолчанию каждая виртуальная машина получает по 4CPU и 1.5Gb оперативной памяти, это можно изменить в файле `Vagrantfile`
 * После окончания работы будут опубликованы порты 8080 (nginx reverse proxy) и 5601 (kibana).
 * Для Logstash формирует для Elasticsearch и  Kibana фильтр по-умолчанию `logstash-*` с временным фильтром. Отражает количество логов Nginx в произвольном временном интервале. 

### Additional infromation
 * Проверку работоспособности кластера из приложений можно выполнять либо остановкой node1 или node2 (но не обеих одновременно, т.к. тогда возможны проблемы с подъемом MySQL), для этого надо выполнить `vagrant halt node1` после проверки необходимо поднять ноду обратно `vagrant up node1`. 
 * После перезагрузки продукт `status.js` будет автоматически запущен (использую `forever-service`). Так же стартуют автоматически другие службы. 
 * Если будут одновременно отключены обе ноды `node1` & `node2` для корректного включения необходимо сначала поднять 1ю `vagrant up node`, затем сделать инициализацию `vagrant provision node` и только потом поднимать 2ю ноду `vagrant up node2`, это связано с падением кластера Percona-MySQL. 

